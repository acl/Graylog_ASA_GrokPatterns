// Description: IP Shun Logging
rule "ASA Shun IP"
when
    has_field("message") AND
    contains(to_string($message.message), "Shun added", true)
then
    let raw_log = to_string($message.message);
    let header = grok(pattern:"%{IPV4:src_ip}", value: raw_log,only_named_captures: true);
    set_fields(header);
end